{% extends "base.html" %}
{% block content %}
    <p>Logged in as token {{ id }}.</p>
    <div>
        {% if jobs and jobs != [] %}
        <p> View the status of your jobs... </p>
            {% for job in jobs %}
            <br><br>
                {% if job['status'] == 'COMPLETED' %}
                    <form action="/api/users/{{ id }}/job{{ job['_id'] }}.html" method="GET">
                        <p> Job #{{ job['_id'] }} (Submitted on {{ job['submitted'] }}) | Results available! <input type="submit" value="View graph"/> </p>
                    </form>

                    {% for result_file in files[job['_id']] %}
                        <form action="/api/users/{{ id }}/job{{ job['_id'] }}/{{ result_file }}" method="GET">
                        <p style="padding-left:5em; display:list-item"> File: {{ result_file|safe }} <input type="submit" value="Download"/> </p>
                        </form>
                    {% endfor %}
                    <form action="/api/users/{{ id }}/job{{ job['_id'] }}/job_results.zip" method="GET">
                    <p style="padding-left:5em; font-weight: bold;"> Download zipped results (excluding .mc files) <input type="submit" value="Download"/> </p>
                    </form>


                {% elif job['status'] == 'RUNNING' %}
                    <p> Job #{{ job['_id'] }} (Submitted on {{ job['submitted'] }}) | Status: running... </p>

                {% elif job['status'] == 'PENDING' %}
                <p> Job #{{ job['_id'] }} (Submitted on {{ job['submitted'] }}) | Status: pending...</p>

                {% endif %}

            {% endfor %}
        {% else %}
        <p> You currently have no jobs running. </p>
        {% endif %}
    </div>

    <br><br>
    <p>Submit a new job... <form action="{{ url_for('fit_job') }}" method="GET"> <input style="display:inline;" type="submit" value="Go"/></form></p>

    <form action="{{ url_for('logout', redirect=1) }}" method="GET">
        <p><input type="submit" value="Logout"/></p>
    </form>

{% endblock %}
