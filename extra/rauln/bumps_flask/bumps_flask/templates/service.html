{% extends "base.html" %}
{% block content %}


<!-- Error macro from https://wtforms.readthedocs.io/en/1.0.5/specific_problems.html with modifications -->
    {% macro with_errors(field) %}
        <div class="form_field">
        {% if field.errors %}
            {% set css_class = 'has_error ' + kwargs.pop('class', '') %}
            {{ field(class=css_class, **kwargs) }}
            <ul class="errors" style="color: red;">{% for _, error in field.errors.iteritems() %}<li>{{ ''.join(error)|e }}</li>{% endfor %}</ul>
        {% else %}
            {{ field(**kwargs) }}
        {% endif %}
        </div>
    {% endmacro %}
<!--  -->

    {% if results %}
    <h4> Results </h4>

    {% if data %}
        {% for key in data.keys() %}
            {% if 'csrf_token' not in key %}
                <p>{{key}}: {{data[key]}} </p>
            {% endif %}
        {% endfor %}
    {% endif %}
    {% else %}

    <h4> Time to work with some data</h4>

    <br>
    <p> TESTING: Fitting with a straight line as described in the <a href="http://bumps.readthedocs.io/en/latest/tutorial/curvefit/curve.html"> bumps docs</a>.</p>
    <form action="" method="POST">
        {{ form.hidden_tag() }}
        {% for field in form if field.widget.input_type != 'hidden' %}

    <br>   {{ with_errors(field, style='font-weight: bold') }}

            {% endfor %}

        <input type="submit" value="Submit" /> </p>
    </form>
    {#
    {% if %}
    <p> (This should show up if a user has a fit job running:) Check the status of your fit. </p>
    {% endif %}

    {% if %}
    <p> (This should show up if a fit job has finished running:) Check the results of your fit. </p>
    {% endif %}
    #}

    {% endif %}
    <form action="{{url_for('dashboard')}}" method="GET">
        <p><input type="submit" value="Back"/></p>
    </form>


{% endblock %}
